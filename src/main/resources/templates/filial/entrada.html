<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Entrada de Moto - SmartPatio</title>
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/filial.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
<div th:replace="~{fragments/header :: main-header}"></div>

<main class="patio-container content">
    <h1><i class="fas fa-sign-in-alt"></i> Entrada de Moto</h1>
    <p class="subtitle"><i class="fas fa-motorcycle"></i> Simulando entrada no pátio...</p>
    <div th:if="${entradaRealizada == false}" class="no-data-message">
        <p><i class="fas fa-video-slash"></i> A câmera não detectou nenhuma moto entrando no momento.</p>
    </div>

    <div th:if="${entradaRealizada == true}">
        <div id="log" class="console"></div>
    </div>

    <a href="/" class="btn-voltar"><i class="fas fa-arrow-left"></i> Voltar ao menu</a>
</main>

<div th:replace="~{fragments/footer :: main-footer}"></div>

<script th:inline="javascript">
    const placa = /*[[${placa}]]*/ "";
    const carrapato = /*[[${carrapato}]]*/ "";

    function simulateEntrada(moto, carrapato) {
        const log = document.getElementById("log");
        log.innerHTML = "<i class='fas fa-search'></i> Identificando placa...";

        setTimeout(() => { log.innerHTML = "<i class='fas fa-check-circle'></i> Moto <b>" + moto + "</b> identificada";}, 1500);

        setTimeout(() => { log.innerHTML += "<br><span id='loading-carrapato'><i class='fas fa-spinner fa-spin'></i> Vinculando carrapato...</span>";}, 3000);

        setTimeout(() => {
            const loading = document.getElementById("loading-carrapato");
            if (loading) loading.remove();
            log.innerHTML += "<br><i class='fas fa-check-circle'></i> Carrapato <b>" + carrapato + "</b> vinculado";
        }, 4500);

        setTimeout(() => {
            log.innerHTML += "<br><br><i class='fas fa-warehouse'></i> Moto <b>" + moto + "</b> entrou no pátio com carrapato <b>" + carrapato + "</b>!";
        }, 6000);
    }

    simulateEntrada(placa, carrapato);
</script>
</body>
</html>
